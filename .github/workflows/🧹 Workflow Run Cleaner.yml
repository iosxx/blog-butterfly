name: 🧹 自动全量清理工作流历史

on:
  # 每月1日自动执行全量清理
  schedule:
    - cron: '0 0 1 * *'
  # 或手动触发（无需确认）
  workflow_dispatch:

jobs:
  cleanup:
    runs-on: ubuntu-latest
    permissions:
      actions: write
    steps:
      - name: 执行全量清理
        uses: Mattraks/delete-workflow-runs@main
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          retain_days: 0           # 删除所有旧于0天的记录（即全量删除）
          keep_minimum_runs: 0     # 不保留任何运行记录
          delete_workflow_by_state_pattern: 'completed'  # 仅删除已完成的工作流
          dry_run: false           # 直接执行删除操作
